!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("datasets-lib"),require("rxjs"),require("@angular/router"),require("rxjs/operators"),require("@angular/core"),require("@angular/common"),require("ngx-store"),require("shared-lib"),require("forms-lib"),require("@angular/cdk/layout"),require("@angular/material")):"function"==typeof define&&define.amd?define("characters-lib",["exports","datasets-lib","rxjs","@angular/router","rxjs/operators","@angular/core","@angular/common","ngx-store","shared-lib","forms-lib","@angular/cdk/layout","@angular/material"],t):t(e["characters-lib"]={},e.DatasetsLib,e.rxjs,e.ng.router,e.rxjs.operators,e.ng.core,e.ng.common,e.NgxStore,e.SharedLib,e.FormsLib,e.ng.cdk.layout,e.ng.material)}(this,function(e,t,a,r,n,o,i,c,s,u,l,d){"use strict";function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(a=o.next()).done;)i.push(a.value)}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=o["return"])&&r.call(o)}finally{if(n)throw n.error}}return i}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}var m=function C(){this.uuid=null,this.name="Default Character",this.dob=123,this.species="Human",this.category=["General"]},f=function(){function e(e,t,r){this.localStorageService=e,this.uuidService=t,this.datasetService=r,this.initialized=!1,this.charactersStream=new a.BehaviorSubject(null),this.currentStream=new a.BehaviorSubject(null)}return Object.defineProperty(e.prototype,"characters",{get:function(){return this.charactersStream.asObservable()},enumerable:!0,configurable:!0}),e.prototype.setCharacters=function(e){this.charactersStream.next(e),this.localStorageService.set("characters",e)},e.prototype.getCharacter=function(t){return t?this.charactersStream.pipe(n.map(function(e){return e.find(function(e){return e.uuid===t.uuid})})):this.charactersStream.pipe(n.map(function(e){return e[0]}))},e.prototype.getCharacterById=function(t){return this.charactersStream.pipe(n.map(function(e){return e.find(function(e){return e.uuid===t})}))},Object.defineProperty(e.prototype,"current",{get:function(){return this.currentStream.asObservable()},enumerable:!0,configurable:!0}),e.prototype.setCurrent=function(e){this.currentStream.next(e),this.localStorageService.set("currentCharacter",e)},e.prototype.ngOnInit=function(){},e.prototype.init=function(){var t=this;return this.initialized||(this.loadCharacters(),this.initialized=!0),new Promise(function(e){e(t.initialized)})},e.prototype.loadCharacters=function(){var t,r=this;this.datasetService.getCharacters().subscribe(function(e){t=e,console.log(t),r.setCharacters(t),r.loadCurrent(),console.log("Characters loaded from SwAPI.co!")})},e.prototype.loadCurrent=function(){var t=this.localStorageService.get("current");t||(console.log("No current character in LocalStorage."),this.characters.subscribe(function(e){return t=e[0]})),this.setCurrent(t),console.log("Current set to: ",t.title)},e.prototype.createCharacter=function(){var e=new m;return e.uuid=this.uuidService.generate(),e},e.prototype.addCharacters=function(e){var t,r;console.log("adding chrs: ",e);try{for(var a=function i(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}(e),n=a.next();!n.done;n=a.next()){var o=n.value;this.uuidService.cache(o.uuid)}}catch(c){t={error:c}}finally{try{n&&!n.done&&(r=a["return"])&&r.call(a)}finally{if(t)throw t.error}}this.setCharacters(e)},e.prototype.addCharacter=function(e){this.uuidService.cache(e.uuid);var t=p(this.charactersStream.getValue(),[e]);this.setCharacters(t)},e.prototype.updateCharacter=function(t){var e=p(this.charactersStream.getValue()),r=e.findIndex(function(e){return e.uuid===t.uuid});e.splice(r,1,t),this.setCharacters(e)},e.prototype.deleteCharacter=function(t){var r,a,e=this.charactersStream.getValue().filter(function(e){return e.uuid!==t.uuid});if(this.uuidService.release(t.uuid),!e.length){var n=this.createCharacter();e.push(n)}(this.setCharacters(e),this.current.subscribe(function(e){return r=e.uuid}),t.uuid===r)&&(this.characters.subscribe(function(e){return a=e[0]}),this.setCurrent(a))},e.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:c.LocalStorageService},{type:s.UuidService},{type:t.DatasetsLibService}]},e.ngInjectableDef=o.defineInjectable({factory:function(){return new e(o.inject(c.LocalStorageService),o.inject(s.UuidService),o.inject(t.DatasetsLibService))},token:e,providedIn:"root"}),e}(),b=function(){function e(e){this.charactersService=e,this.characters=this.charactersService.characters,this._current=this.charactersService.current}return e.prototype.ngOnInit=function(){},Object.defineProperty(e.prototype,"current",{get:function(){return this._current},set:function(e){this.charactersService.setCurrent(e)},enumerable:!0,configurable:!0}),e.decorators=[{type:o.Component,args:[{selector:"characters-home",template:"<characters-collection></characters-collection>",styles:[""]}]}],e.ctorParameters=function(){return[{type:f}]},e}(),g=function(){function e(e){this.charactersLibService=e,this.current=this.charactersLibService.current}return e.prototype.ngOnInit=function(){console.log(this.current)},e.decorators=[{type:o.Component,args:[{selector:"characters-profile",template:'<ng-container *ngIf="(current | async) as profile; else loading">\n<mat-card class="dashboard-card">\n  <mat-card-header>\n    <mat-card-title>\n      {{profile.name}}\n      <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">\n        <mat-icon>more_vert</mat-icon>\n      </button>\n      <mat-menu #menu="matMenu" xPosition="before">\n        <button mat-menu-item>Expand</button>\n        <button mat-menu-item>Remove</button>\n      </mat-menu>\n    </mat-card-title>\n  </mat-card-header>\n  <mat-card-content class="dashboard-card-content">\n    <ul>\n      <li>{{ profile.birth_year }}</li>\n      <li>{{ profile.gender }}</li>\n      <li>{{ profile.hair_color }}</li>\n      <li>{{ profile.skin_color }}</li>\n      <li>{{ profile.species }}</li>\n    </ul>\n  </mat-card-content>\n</mat-card>\n</ng-container>\n<ng-template #loading>Profile loading...</ng-template>\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:f}]},e}(),v=function(){function e(e,t,r){this.router=e,this.breakpointObserver=t,this.charactersLibService=r,this.characters=this.charactersLibService.characters,this.cols=this.breakpointObserver.observe([l.Breakpoints.XSmall,l.Breakpoints.Small,l.Breakpoints.Medium,l.Breakpoints.Large,l.Breakpoints.XLarge]).pipe(n.map(function(e){return e.breakpoints[l.Breakpoints.XSmall]?1:e.breakpoints[l.Breakpoints.Small]?2:e.breakpoints[l.Breakpoints.Medium]?3:e.breakpoints[l.Breakpoints.Large]?4:e.breakpoints[l.Breakpoints.XLarge]?5:void 0}))}return e.prototype.viewCharacter=function(e){this.charactersLibService.setCurrent(e),this.router.navigate(["profile"])},e.decorators=[{type:o.Component,args:[{selector:"characters-collection",template:'<div class="grid-container">\n  <h1 class="mat-h1">Characters</h1>\n  <mat-grid-list cols="{{cols | async}}" rowHeight="380px">\n    <mat-grid-tile *ngFor="let card of characters | async" [colspan]="1" [rowspan]="1">\n      <mat-card class="dashboard-card" (click)="viewCharacter(card)">\n        <mat-card-header>\n          <mat-card-title>\n            {{card.name}}\n            <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">\n              <mat-icon>more_vert</mat-icon>\n            </button>\n            <mat-menu #menu="matMenu" xPosition="before">\n              <button mat-menu-item>Expand</button>\n              <button mat-menu-item>Remove</button>\n            </mat-menu>\n          </mat-card-title>\n        </mat-card-header>\n        <mat-card-content class="dashboard-card-content">\n          <ul>\n            <li>{{ card.birth_year }}</li>\n            <li>{{ card.gender }}</li>\n            <li>{{ card.hair_color }}</li>\n            <li>{{ card.skin_color }}</li>\n            <li>{{ card.species }}</li>\n          </ul>\n        </mat-card-content>\n      </mat-card>\n    </mat-grid-tile>\n  </mat-grid-list>\n</div>\n',styles:[".grid-container{margin:30px}.dashboard-card{position:absolute;width:250px;height:350px;top:15px;left:15px;right:15px;bottom:15px}.more-button{position:absolute;top:5px;right:10px}.dashboard-card-content{text-align:center}"]}]}],e.ctorParameters=function(){return[{type:r.Router},{type:l.BreakpointObserver},{type:f}]},e.propDecorators={characters:[{type:o.Input}]},e}();function y(e){return function(){return console.log("Initializing Versed"),e.init()}}var S=function(){function e(){}return e.decorators=[{type:o.NgModule,args:[{declarations:[b,g,v],imports:[i.CommonModule,c.WebStorageModule,u.FormsLibModule,s.SharedLibModule,l.LayoutModule,d.MatToolbarModule,d.MatButtonModule,d.MatSidenavModule,d.MatIconModule,d.MatListModule,d.MatGridListModule,d.MatCardModule,d.MatMenuModule],exports:[b,g,v,u.FormsLibModule],providers:[f,{provide:o.APP_INITIALIZER,useFactory:y,deps:[f],multi:!0}],entryComponents:[]}]}],e}();e.CharactersLibService=f,e.CharactersHomeComponent=b,e.CharactersProfileComponent=g,e.CharactersCollectionComponent=v,e.loadCharacters=y,e.CharactersLibModule=S,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=characters-lib.umd.min.js.map